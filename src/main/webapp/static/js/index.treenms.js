var dg,dg2,d,pwd,tableName,NoSQLDbName,type,rowtype,colums="",searchBG,databaseName,add,primary_key,saveSearch,selectRowCount=0,heightStr=300,sqlArray=[],columnsTemp=[],index=0,messTemp="",databaseConfigId;$(function(){initSqlStudyTree();$.ajax({type:"get",url:"../system/permission/i/getConfigAllDataBase",success:function(a){$.each(a,function(b,c){$("#databaseSelect").append("<option value='"+a[b].id+"'>"+a[b].ip+":"+a[b].port+" </option>")});initDataBase();query()}})});
$("#databaseSelect").change(function(){databaseConfigId=$("#databaseSelect").val();window.mainpage.mainTabs.jumpHome();initDataBase();query()});
function query(){dg2=$("#dg2").datagrid({method:"get",url:"../system/permission/i/selectNoSQLDBStatus/"+databaseConfigId,fit:!0,fitColumns:!0,border:!1,striped:!0,idField:"key",pagination:!0,rownumbers:!0,pageNumber:1,pageSize:50,pageList:[10,20,30,40,50],columns:[[{field:"parameter",title:"\u5c5e\u6027",sortable:!0,width:60},{field:"value",title:"\u503c",sortable:!0,width:75},{field:"content",title:"\u8bf4\u660e",sortable:!0}]],enableHeaderClickMenu:!0,enableHeaderContextMenu:!0,enableRowContextMenu:!1,
rowTooltip:!0,toolbar:"#tb"})}
function initDataBase(){databaseConfigId=$("#databaseSelect").val();dg=$("#pid").treegrid({method:"GET",url:"../system/permission/i/allDatabaseListForNoSQL/"+databaseConfigId,fit:!0,fitColumns:!0,border:!1,idField:"id",treeField:"name",parentField:"pid",iconCls:"icon",animate:!0,rownumbers:!1,singleSelect:!0,striped:!0,columns:[[{field:"name",title:"&nbsp;&nbsp;\u8be6\u60c5",width:210}]],enableHeaderClickMenu:!1,enableHeaderContextMenu:!1,enableRowContextMenu:!0,dataPlain:!1,onClickRow:function(a){NoSQLDbName=
a.name;type=a.type;columnsTemp.length=0;$("#pid").treegrid("getRoot",a.id);"table"==type&&(selectRowCount=0,clickNoSQLDbName(NoSQLDbName))}})}function clickNoSQLDbName(a){window.mainpage.mainTabs.addModule(a,"../system/permission/i/showNoSQLDBData/"+a+"/"+databaseConfigId,"icon-berlin-calendar")}
function initSqlStudyTree(){$("#sqlStudyList").treegrid({method:"GET",url:"../system/permission/i/selectSqlStudy",fit:!0,fitColumns:!0,border:!1,idField:"id",treeField:"title",parentField:"pid",iconCls:"icon",animate:!0,rownumbers:!1,singleSelect:!0,striped:!0,columns:[[{field:"title",title:"&nbsp;&nbsp;\u8be6\u60c5",width:210}]],enableHeaderClickMenu:!1,enableHeaderContextMenu:!1,enableRowContextMenu:!0,dataPlain:!1,onClickRow:function(a){showSQLMess(a.content)}})}
function showSQLMess(a){$.messager.show({title:"SQL Mess",msg:a,timeout:5E3,showType:"slide"})}function showSQLMess2(a){$("#mainTabs").tabs("exists","show SQL")?$("#mainTabs").tabs("select","show SQL"):window.mainpage.mainTabs.addModule("show SQL","../system/permission/i/showSQLMess/","icon-berlin-calendar")}function jsonFormat(){window.mainpage.mainTabs.addModule("Json\u683c\u5f0f\u5316","../system/permission/i/jsonFormat","icon-berlin-calendar")}
function backupDatabase(){window.mainpage.mainTabs.addModule("\u5907\u4efd","../system/permission/i/backupDatabase/"+databaseName,"icon-berlin-calendar")}function ShowConfigPage(){window.mainpage.mainTabs.addModule("\u6570\u636e\u5e93\u914d\u7f6e","../system/permission/i/config","icon-berlin-calendar")}
function ShowPasswordDialog(){pwd=$("#dlgg").dialog({title:"\u4fee\u6539\u5bc6\u7801",width:380,height:160,href:"../system/permission/i/changePass",maximizable:!0,modal:!0,buttons:[{text:"\u786e\u8ba4",iconCls:"icon-edit",handler:function(){$("#mainform").submit()}},{text:"\u53d6\u6d88",iconCls:"icon-cancel",handler:function(){pwd.panel("close")}}]})}function refresh2(){$("#dg2").datagrid("reload")}function clearSQL(){$("#cacheKey").val("");$("#cacheValue").val("")}
function contribute(){$("#addRow").dialog({title:"\u6350\u8d60",width:480,height:500,href:"../system/permission/i/contribute",maximizable:!0,modal:!0,buttons:[{text:"\u5173\u95ed",iconCls:"icon-cancel",handler:function(){$("#addRow").panel("close")}}]})}function help(){$("#addRow").dialog({title:"\u5e2e\u52a9",width:500,height:300,href:"../system/permission/i/help",maximizable:!0,modal:!0,buttons:[{text:"\u5173\u95ed",iconCls:"icon-cancel",handler:function(){$("#addRow").panel("close")}}]})}
function selectTheme(a){editor.setOption("theme",a);executeMessage.setOption("theme",a)}function selectTheme(){var a=document.getElementById("codeThemeSelector");a=a.options[a.selectedIndex].textContent;editor.setOption("theme",a);executeMessage.setOption("theme",a)}var obj,willChangeRow=[];function refresh(a){$("#selectDg"+a).datagrid("reload");$("#selectDg"+a).datagrid("clearSelections").datagrid("clearChecked")}function cancelChange(a){endEdit(a);refresh(a)}
function refresh(a){$("#selectDg"+a).datagrid("reload");$("#selectDg"+a).datagrid("clearSelections").datagrid("clearChecked")}function imgerror(a){a.src="../static/images/logo.png";a.onerror=null}function infoData(){parent.window.mainpage.mainTabs.addModule("\u5b9e\u65f6\u72b6\u6001\u76d1\u63a7","../system/permission/i/infoData/"+databaseConfigId,"icon-standard-bricks")};
